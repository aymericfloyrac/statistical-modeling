Version finale du code, propre, en trois fichiers
